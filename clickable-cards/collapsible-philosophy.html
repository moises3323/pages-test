<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Collapsible Philosophy</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --panel-bg: #878c80;
        --panel-border: rgba(242, 237, 226, 0.65);
        --panel-ink: #f5f1e8;
        --panel-muted: rgba(245, 241, 232, 0.72);
        --arrow-color: #ffffff;
        --panel-shadow: 0 18px 40px rgba(15, 23, 42, 0.25);
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 40px 20px;
        background: radial-gradient(circle at 20% 20%, #f9f5ed, #f1ece4 60%, #e7e1d7 100%),
          repeating-linear-gradient(135deg, rgba(0, 0, 0, 0.04) 0 1px, transparent 1px 10px);
        color: #1f2937;
        font-family: "Avenir Next", "Avenir", "Helvetica Neue", sans-serif;
      }

      .panel {
        width: min(760px, 100%);
        background: var(--panel-bg);
        color: var(--panel-ink);
        border: 1px solid var(--panel-border);
        box-shadow: var(--panel-shadow);
        padding: 28px clamp(18px, 4vw, 40px) 32px;
        position: relative;
      }

      .panel::before {
        content: "";
        position: absolute;
        inset: 14px;
        border: 1px solid rgba(242, 237, 226, 0.35);
        pointer-events: none;
      }

      .panel-title {
        display: none;
      }

      .philosophy-list {
        display: flex;
        flex-direction: column;
        gap: 18px;
        padding: 0;
        margin: 0;
        list-style: none;
      }

      .philosophy-list > .collapse-item {
        border-bottom: 1px solid rgba(242, 237, 226, 0.25);
        padding-bottom: 16px;
      }

      .philosophy-list > .collapse-item:last-child {
        border-bottom: none;
        padding-bottom: 0;
      }

      .collapse-children {
        list-style: none;
        margin: 14px 0 0;
        padding: 0 0 0 16px;
        border-left: 1px solid rgba(242, 237, 226, 0.2);
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .collapse-item.is-nested {
        padding: 0;
        border: none;
      }

      .collapse-item.is-nested .collapse-trigger {
        font-size: clamp(0.84rem, 1.65vw, 1.02rem);
        letter-spacing: 0.06em;
      }

      .collapse-item.is-nested .details-text {
        margin-top: 8px;
        font-size: clamp(0.84rem, 1.4vw, 0.95rem);
      }

      .collapse-heading {
        width: 100%;
        color: inherit;
        font-family: "Montserrat", "Arial", sans-serif;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        font-size: clamp(1rem, 2.1vw, 1.35rem);
        text-align: center;
      }

      .collapse-trigger {
        width: 100%;
        background: transparent;
        border: none;
        padding: 0;
        color: inherit;
        cursor: pointer;
        font-family: "Montserrat", "Arial", sans-serif;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        font-size: clamp(1rem, 2.1vw, 1.35rem);
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
        text-align: left;
      }

      .collapse-trigger:focus-visible {
        outline: 2px solid rgba(245, 241, 232, 0.7);
        outline-offset: 4px;
        border-radius: 6px;
      }

      .summary-icon {
        color: var(--arrow-color);
        font-size: clamp(1.45rem, 2.9vw, 1.95rem);
        line-height: 1;
        display: inline-flex;
        align-items: center;
        transition: transform 0.35s ease;
      }

      .collapse-item.is-open > .collapse-trigger .summary-icon {
        transform: rotate(90deg);
      }

      .collapse-panel {
        height: 0;
        overflow: hidden;
        transform: translateY(-6px);
        transition: height 0.65s cubic-bezier(0.16, 1, 0.3, 1),
          opacity 0.45s ease, transform 0.45s ease;
        opacity: 0;
      }

      .collapse-item.is-open .collapse-panel {
        opacity: 1;
        transform: translateY(0);
      }

      .collapse-inner {
        overflow: hidden;
      }

      .details-text {
        margin: 12px 0 0;
        color: var(--panel-muted);
        font-size: clamp(0.9rem, 1.5vw, 1rem);
        line-height: 1.6;
        font-family: "Avenir Next", "Avenir", "Helvetica Neue", sans-serif;
        opacity: 0;
        transition: opacity 0.4s ease 0.05s;
      }

      .collapse-item.is-open .details-text {
        opacity: 1;
      }

      .collapse-item.is-static .details-text {
        opacity: 1;
      }

      .static-content {
        margin-top: 10px;
      }

      .philosophy-list > .collapse-item:first-child .collapse-heading {
        font-size: 2.45rem;
        color: #ffffff;
      }

      @media (max-width: 640px) {
        .panel::before {
          inset: 10px;
        }
      }

      @media (prefers-reduced-motion: reduce) {
        .collapse-panel,
        .details-text,
        .summary-icon {
          transition: none;
        }
      }
    </style>
  </head>
  <body>
    <section class="panel" aria-label="Food philosophy">
      <div class="panel-title"></div>
      <ul class="philosophy-list" id="philosophy-list"></ul>
    </section>

    <script id="philosophy-data" type="application/json">
      {
        "title": "Food Philosophy",
        "items": [
          {
            "title": "Our Commitment",
            "collapsible": false,
            "text": "We honor our role in the food supply chain by maintaining high standards for the products on our shelves, the ingredients in our kitchens, and the practices on our farms."
          },
          {
            "title": "Nutrient Rich",
            "open": true,
            "text": "We focus on practices that protect nutritional density and maximize bioavailability, so you get the most out of every bite.",
            "children": [
              {
                "title": "Sourcing Standards",
                "text": "We review sourcing inputs at every stage to maintain consistency and quality."
              },
              {
                "title": "Long-Term Stewardship",
                "text": "We prioritize long-term practices that support people, animals, and the land."
              }
            ]
          },
          {
            "title": "Always Real",
            "text": "We vet every product and ingredient before bringing it into our stores or kitchens, because food should be made of food."
          },
          {
            "title": "Intentionally Sourced",
            "text": "We prioritize sourcing from farmers and producers who honor heritage practices and uphold high ethical standards for people, animals, and the environment."
          }
        ]
      }
    </script>

    <script>
      (function () {
        const reduceMotion = window.matchMedia(
          "(prefers-reduced-motion: reduce)",
        ).matches;
        const panelTitle = document.querySelector(".panel-title");
        const list = document.getElementById("philosophy-list");
        const dataNode = document.getElementById("philosophy-data");

        const DEFAULT_DATA = {
          title: "Food Philosophy",
          items: [
            {
              title: "Our Commitment",
              collapsible: false,
              text: "We honor our role in the food supply chain by maintaining high standards for the products on our shelves, the ingredients in our kitchens, and the practices on our farms.",
            },
            {
              title: "Nutrient Rich",
              open: true,
              text: "We focus on practices that protect nutritional density and maximize bioavailability, so you get the most out of every bite.",
              children: [
                {
                  title: "Sourcing Standards",
                  text: "We review sourcing inputs at every stage to maintain consistency and quality.",
                },
                {
                  title: "Long-Term Stewardship",
                  text: "We prioritize long-term practices that support people, animals, and the land.",
                },
              ],
            },
            {
              title: "Always Real",
              text: "We vet every product and ingredient before bringing it into our stores or kitchens, because food should be made of food.",
            },
            {
              title: "Intentionally Sourced",
              text: "We prioritize sourcing from farmers and producers who honor heritage practices and uphold high ethical standards for people, animals, and the environment.",
            },
          ],
        };

        function normalizeEntry(entry) {
          const raw = entry && typeof entry === "object" ? entry : {};
          const childrenRaw = Array.isArray(raw.children) ? raw.children : [];
          const isCollapsible = raw.collapsible !== false;
          return {
            title: typeof raw.title === "string" ? raw.title : "",
            text: typeof raw.text === "string" ? raw.text : "",
            collapsible: isCollapsible,
            open: isCollapsible ? Boolean(raw.open) : true,
            children: childrenRaw.map(normalizeEntry),
          };
        }

        const NORMALIZED_DEFAULT_DATA = {
          ...DEFAULT_DATA,
          items: DEFAULT_DATA.items.map(normalizeEntry),
        };

        function parseData() {
          if (!dataNode) return NORMALIZED_DEFAULT_DATA;
          try {
            const parsed = JSON.parse(dataNode.textContent || "{}");
            const items = Array.isArray(parsed.items)
              ? parsed.items.map(normalizeEntry)
              : [];
            if (!items.length) return NORMALIZED_DEFAULT_DATA;
            return {
              title:
                typeof parsed.title === "string" && parsed.title.trim()
                  ? parsed.title
                  : NORMALIZED_DEFAULT_DATA.title,
              items,
            };
          } catch {
            return NORMALIZED_DEFAULT_DATA;
          }
        }

        function createCollapseItem(entry, path, depth) {
          const item = document.createElement("li");
          item.className = "collapse-item";
          if (depth > 0) item.classList.add("is-nested");
          const isOpen = entry.collapsible ? entry.open : true;
          if (isOpen) item.classList.add("is-open");

          if (!entry.collapsible) {
            item.classList.add("is-static");
            const heading = document.createElement("div");
            heading.className = "collapse-heading";
            heading.textContent = entry.title || "Untitled";

            const content = document.createElement("div");
            content.className = "static-content";

            if (entry.text) {
              const text = document.createElement("p");
              text.className = "details-text";
              text.textContent = entry.text;
              content.append(text);
            }

            if (entry.children.length) {
              const children = document.createElement("ul");
              children.className = "collapse-children";
              entry.children.forEach((child, index) => {
                children.append(createCollapseItem(child, path.concat(index + 1), depth + 1));
              });
              content.append(children);
            }

            item.append(heading, content);
            return item;
          }

          const panelId = `philosophy-${path.join("-")}`;

          const trigger = document.createElement("button");
          trigger.className = "collapse-trigger";
          trigger.type = "button";
          trigger.setAttribute("aria-expanded", String(isOpen));
          trigger.setAttribute("aria-controls", panelId);
          trigger.append(document.createTextNode(entry.title || "Untitled"));

          const icon = document.createElement("span");
          icon.className = "summary-icon";
          icon.textContent = "â€º";
          trigger.append(icon);

          const panel = document.createElement("div");
          panel.className = "collapse-panel";
          panel.id = panelId;
          panel.style.height = isOpen ? "auto" : "0px";

          const inner = document.createElement("div");
          inner.className = "collapse-inner";

          if (entry.text) {
            const text = document.createElement("p");
            text.className = "details-text";
            text.textContent = entry.text;
            inner.append(text);
          }

          if (entry.children.length) {
            const children = document.createElement("ul");
            children.className = "collapse-children";
            entry.children.forEach((child, index) => {
              children.append(createCollapseItem(child, path.concat(index + 1), depth + 1));
            });
            inner.append(children);
          }

          panel.append(inner);
          item.append(trigger, panel);
          return item;
        }

        function bindCollapse(item) {
          const trigger = item.querySelector(":scope > .collapse-trigger");
          const panel = item.querySelector(":scope > .collapse-panel");
          if (!trigger || !panel) return;

          trigger.addEventListener("click", () => {
            const isOpen = item.classList.contains("is-open");

            if (reduceMotion) {
              item.classList.toggle("is-open", !isOpen);
              trigger.setAttribute("aria-expanded", String(!isOpen));
              panel.style.height = !isOpen ? "auto" : "0px";
              return;
            }

            if (isOpen) {
              panel.style.height = `${panel.scrollHeight}px`;
              requestAnimationFrame(() => {
                item.classList.remove("is-open");
                trigger.setAttribute("aria-expanded", "false");
                panel.style.height = "0px";
              });
              return;
            }

            item.classList.add("is-open");
            trigger.setAttribute("aria-expanded", "true");
            panel.style.height = "0px";
            requestAnimationFrame(() => {
              panel.style.height = `${panel.scrollHeight}px`;
            });
          });

          panel.addEventListener("transitionend", (event) => {
            if (event.propertyName !== "height") return;
            if (item.classList.contains("is-open")) {
              panel.style.height = "auto";
            }
          });
        }

        const data = parseData();
        panelTitle.textContent = data.title;
        list.replaceChildren(
          ...data.items.map((entry, index) => createCollapseItem(entry, [index + 1], 0)),
        );
        list.querySelectorAll(".collapse-item").forEach(bindCollapse);
      })();
    </script>
  </body>
</html>
